{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>ğŸ“¥ TÃ©lÃ©chargement</h2>
  <p class="muted">Convertissez vos vidÃ©os YouTube prÃ©fÃ©rÃ©es en MP3 ou MP4 de haute qualitÃ©.</p>
  
  <form method="post" id="downloadForm">
    <div class="form-group">
      <label class="form-label">ğŸ”— Lien YouTube</label>
      <input type="text" name="url" placeholder="https://www.youtube.com/watch?v=..." required>
      <p class="form-hint">Collez l'URL complÃ¨te de la vidÃ©o YouTube</p>
    </div>
    
    <div class="form-group">
      <label class="form-label">ğŸ“¦ Format de sortie</label>
      <div class="download-options">
        <label class="download-option selected" data-mode="mp3">
          <input type="radio" name="mode" value="mp3" checked>
          <span class="download-option-icon">ğŸµ</span>
          <span class="download-option-label">MP3</span>
          <span class="download-option-desc">Audio</span>
        </label>
        <label class="download-option" data-mode="mp4">
          <input type="radio" name="mode" value="mp4">
          <span class="download-option-icon">ğŸ¥</span>
          <span class="download-option-label">MP4</span>
          <span class="download-option-desc">VidÃ©o</span>
        </label>
      </div>
    </div>
    
    <button type="submit" id="downloadBtn">
      â¬‡ï¸ TÃ©lÃ©charger (1 crÃ©dit)
    </button>
  </form>
  
  {% if msg %}<p class="error">{{ msg }}</p>{% endif %}
  
  {% if download_info %}
  <div class="download-info-card">
    <h3>ğŸ“‹ Informations du tÃ©lÃ©chargement</h3>
    <div class="download-info-grid">
      <div class="download-info-item">
        <span class="download-info-label">ğŸ“¹ Titre</span>
        <span class="download-info-value">{{ download_info.title }}</span>
      </div>
      <div class="download-info-item">
        <span class="download-info-label">ğŸ‘¤ ChaÃ®ne</span>
        <span class="download-info-value">{{ download_info.uploader }}</span>
      </div>
      <div class="download-info-item">
        <span class="download-info-label">â±ï¸ DurÃ©e</span>
        <span class="download-info-value">{{ download_info.duration_str }}</span>
      </div>
      <div class="download-info-item">
        <span class="download-info-label">ğŸ‘ï¸ Vues</span>
        <span class="download-info-value">{{ download_info.views_str }}</span>
      </div>
      {% if download_info.resolution %}
      <div class="download-info-item">
        <span class="download-info-label">ğŸ“º RÃ©solution</span>
        <span class="download-info-value">{{ download_info.resolution }}</span>
      </div>
      {% endif %}
      {% if download_info.filesize_str %}
      <div class="download-info-item">
        <span class="download-info-label">ğŸ“ Taille</span>
        <span class="download-info-value">{{ download_info.filesize_str }}</span>
      </div>
      {% endif %}
    </div>
    <p class="download-success">âœ… TÃ©lÃ©chargement terminÃ© avec succÃ¨s !</p>
  </div>
  {% endif %}
  
  <p class="muted" style="text-align:center;margin-top:20px;">
    â³ Les tÃ©lÃ©chargements lourds peuvent prendre du temps. Restez sur la page.
  </p>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const downloadOptions = document.querySelectorAll('.download-option');
  const form = document.getElementById('downloadForm');
  const downloadBtn = document.getElementById('downloadBtn');
  
  // Format option selection
  downloadOptions.forEach(function(option) {
    option.addEventListener('click', function() {
      downloadOptions.forEach(function(o) { o.classList.remove('selected'); });
      option.classList.add('selected');
    });
  });
  
  // Form submission loading state
  form.addEventListener('submit', function() {
    downloadBtn.disabled = true;
    downloadBtn.textContent = 'â³ TÃ©lÃ©chargement en cours...';
  });
});
</script>
{% endblock %}