{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>ğŸµ Conversion Audio</h2>
  <p class="muted">Convertissez vos fichiers audio d'un format Ã  un autre facilement.</p>
  
  <form method="post" enctype="multipart/form-data" id="convertForm">
    <div class="form-group">
      <label class="form-label">ğŸ“ Fichier audio source</label>
      <div class="file-upload-wrapper">
        <input type="file" name="audio_file" id="audioFile" accept=".mp3,.wav,.m4a,.aac,.ogg,.flac,.wma" required>
        <label for="audioFile" class="file-upload-label">
          <span class="file-upload-icon">ğŸ“‚</span>
          <span class="file-upload-text" id="fileName">Choisir un fichier audio</span>
        </label>
      </div>
      <p class="form-hint">Formats supportÃ©s : MP3, WAV, M4A, AAC, OGG, FLAC, WMA (max 50 MB)</p>
    </div>
    
    <div class="form-group">
      <label class="form-label">ğŸ”„ Format de sortie</label>
      <div class="convert-options">
        <label class="convert-option selected" data-format="mp3">
          <input type="radio" name="output_format" value="mp3" checked>
          <span class="convert-option-icon">ğŸµ</span>
          <span class="convert-option-label">MP3</span>
          <span class="convert-option-desc">Universel</span>
        </label>
        <label class="convert-option" data-format="wav">
          <input type="radio" name="output_format" value="wav">
          <span class="convert-option-icon">ğŸ¼</span>
          <span class="convert-option-label">WAV</span>
          <span class="convert-option-desc">Sans perte</span>
        </label>
        <label class="convert-option" data-format="aac">
          <input type="radio" name="output_format" value="aac">
          <span class="convert-option-icon">ğŸ§</span>
          <span class="convert-option-label">AAC</span>
          <span class="convert-option-desc">Haute qualitÃ©</span>
        </label>
        <label class="convert-option" data-format="ogg">
          <input type="radio" name="output_format" value="ogg">
          <span class="convert-option-icon">ğŸ”Š</span>
          <span class="convert-option-label">OGG</span>
          <span class="convert-option-desc">Libre</span>
        </label>
        <label class="convert-option" data-format="flac">
          <input type="radio" name="output_format" value="flac">
          <span class="convert-option-icon">ğŸ’</span>
          <span class="convert-option-label">FLAC</span>
          <span class="convert-option-desc">Lossless</span>
        </label>
      </div>
    </div>
    
    <div class="form-group">
      <label class="form-label">âš™ï¸ QualitÃ© audio</label>
      <select name="quality" class="quality-select">
        <option value="high">ğŸ”¥ Haute qualitÃ© (320 kbps)</option>
        <option value="medium" selected>âš¡ QualitÃ© moyenne (192 kbps)</option>
        <option value="low">ğŸ’¨ QualitÃ© standard (128 kbps)</option>
      </select>
    </div>
    
    <button type="submit" id="convertBtn">
      ğŸ”„ Convertir (1 crÃ©dit)
    </button>
  </form>
  
  {% if msg %}<p class="error">{{ msg }}</p>{% endif %}
  {% if success_msg %}<p class="flash success">{{ success_msg }}</p>{% endif %}
  
  <div class="convert-info">
    <h3>ğŸ’¡ Informations</h3>
    <ul class="about-list">
      <li>La conversion utilise FFmpeg pour une qualitÃ© optimale</li>
      <li>Les fichiers sont supprimÃ©s aprÃ¨s tÃ©lÃ©chargement</li>
      <li>Taille maximale : 50 MB par fichier</li>
    </ul>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Format option selection
  const convertOptions = document.querySelectorAll('.convert-option');
  convertOptions.forEach(function(option) {
    option.addEventListener('click', function() {
      convertOptions.forEach(function(o) { o.classList.remove('selected'); });
      option.classList.add('selected');
    });
  });
  
  // File input display
  const fileInput = document.getElementById('audioFile');
  const fileNameSpan = document.getElementById('fileName');
  
  fileInput.addEventListener('change', function() {
    if (fileInput.files.length > 0) {
      const file = fileInput.files[0];
      const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
      fileNameSpan.textContent = file.name + ' (' + sizeMB + ' MB)';
      fileNameSpan.classList.add('has-file');
    } else {
      fileNameSpan.textContent = 'Choisir un fichier audio';
      fileNameSpan.classList.remove('has-file');
    }
  });
  
  // Form submission loading state
  const form = document.getElementById('convertForm');
  const convertBtn = document.getElementById('convertBtn');
  
  form.addEventListener('submit', function() {
    convertBtn.disabled = true;
    convertBtn.textContent = 'â³ Conversion en cours...';
  });
});
</script>
{% endblock %}
